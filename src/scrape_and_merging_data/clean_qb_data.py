'''
This file is a template to clean any QB's data from Pro-Football-Reference.com.
Just replace the QB name and raw_data variables
'''


import pandas as pd
import io
import numpy as np

# SET THESE VARIABLES FOR EACH QB
qb_name = "Josh Allen"
raw_data = ''',,,,,,,,,,Passing,Passing,Passing,Passing,Passing,Passing,Passing,Passing,Passing,Passing,Passing,Rushing,Rushing,Rushing,Rushing,Receiving,Receiving,Receiving,Receiving,Receiving,Receiving,Receiving,,Tackles,Tackles,Tackles,Tackles,Tackles,,Fumbles,Fumbles,Fumbles,Fumbles,Fumbles,Fumbles,Snap Counts,Snap Counts,Snap Counts,Snap Counts,Snap Counts,Snap Counts
Rk,Gcar,Gtm,Week,Date,Team,,Opp,Result,GS,Cmp,Att,Cmp%,Yds,TD,Int,Y/A,AY/A,Rate,Sk,Yds,Att,Yds,TD,Y/A,Tgt,Rec,Yds,Y/R,TD,Ctch%,Y/Tgt,Sk,Comb,Solo,Ast,TFL,QBHits,Sfty,Fmb,FL,FF,FR,Yds,FRTD,OffSnp,Off%,DefSnp,Def%,STSnp,ST%
1,1,1,1,2018-09-09,BUF,@,BAL,L 3-47,,6,15,40.0,74,0,0,4.9,4.93,56.0,3,16,4,26,0,6.5,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,32,50.0,0,0.0,0,0.0
2,2,2,2,2018-09-16,BUF,,LAC,L 20-31,*,18,33,54.5,245,1,2,7.4,5.30,63.3,5,36,8,32,0,4.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,62,100.0,0,0.0,0,0.0
3,3,3,3,2018-09-23,BUF,@,MIN,W 27-6,*,15,22,68.2,196,1,0,8.9,9.82,111.2,3,32,10,39,2,3.9,0,0,0,,0,,,0.0,0,0,0,0,0,0,3,0,0,2,-14,0,67,100.0,0,0.0,0,0.0
4,4,4,4,2018-09-30,BUF,@,GNB,L 0-22,*,16,33,48.5,151,0,2,4.6,1.85,36.3,7,64,5,19,0,3.8,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,58,100.0,0,0.0,0,0.0
5,5,5,5,2018-10-07,BUF,,TEN,W 13-12,*,10,19,52.6,82,0,1,4.3,1.95,42.0,1,3,4,19,1,4.8,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,65,100.0,0,0.0,0,0.0
6,6,6,6,2018-10-14,BUF,@,HOU,L 13-20,*,10,17,58.8,84,0,0,4.9,4.94,71.7,2,16,4,20,0,5.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,38,61.3,0,0.0,0,0.0
7,7,11,12,2018-11-25,BUF,,JAX,W 24-21,*,8,19,42.1,160,1,0,8.4,9.47,89.8,0,0,13,99,1,7.6,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,58,100.0,0,0.0,0,0.0
8,8,12,13,2018-12-02,BUF,@,MIA,L 17-21,*,18,33,54.5,231,2,2,7.0,5.48,71.7,2,14,9,135,0,15.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,72,100.0,0,0.0,0,0.0
9,9,13,14,2018-12-09,BUF,,NYJ,L 23-27,*,18,36,50.0,206,0,2,5.7,3.22,44.4,3,14,9,101,1,11.2,1,0,0,,0,0.0,0.0,0.0,0,0,0,0,0,0,1,1,0,0,0,0,76,100.0,0,0.0,0,0.0
10,10,14,15,2018-12-16,BUF,,DET,W 14-13,*,13,26,50.0,204,1,0,7.8,8.62,89.3,1,9,9,16,1,1.8,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,68,100.0,0,0.0,0,0.0
11,11,15,16,2018-12-23,BUF,@,NWE,L 12-24,*,20,41,48.8,217,1,2,5.3,3.59,52.6,0,0,5,30,0,6.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,61,100.0,0,0.0,0,0.0
12,12,16,17,2018-12-30,BUF,,MIA,W 42-17,*,17,26,65.4,224,3,1,8.6,9.19,114.9,1,9,9,95,2,10.6,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,62,100.0,0,0.0,0,0.0
13,13,1,1,2019-09-08,BUF,@,NYJ,W 17-16,*,24,37,64.9,254,1,2,6.9,4.97,71.2,1,12,10,38,1,3.8,0,0,0,,0,,,0.0,0,0,0,0,0,0,2,2,0,0,-1,0,66,100.0,0,0.0,0,0.0
14,14,2,2,2019-09-15,BUF,@,NYG,W 28-14,*,19,30,63.3,253,1,0,8.4,9.10,101.1,3,16,7,21,1,3.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,70,100.0,0,0.0,0,0.0
15,15,3,3,2019-09-22,BUF,,CIN,W 21-17,*,23,36,63.9,243,1,1,6.8,6.06,81.1,1,2,9,46,0,5.1,0,0,0,,0,,,0.0,0,0,0,0,0,0,2,0,0,1,0,0,76,100.0,0,0.0,0,0.0
16,16,4,4,2019-09-29,BUF,,NWE,L 10-16,*,13,28,46.4,153,0,3,5.5,0.64,24.0,4,31,5,26,1,5.2,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,58,73.4,0,0.0,0,0.0
17,17,5,5,2019-10-06,BUF,@,TEN,W 14-7,*,23,32,71.9,219,2,1,6.8,6.69,98.3,4,15,10,27,0,2.7,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,64,100.0,0,0.0,0,0.0
18,18,6,7,2019-10-20,BUF,,MIA,W 31-21,*,16,26,61.5,202,2,0,7.8,9.31,111.4,2,14,4,32,0,8.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,55,100.0,0,0.0,0,0.0
19,19,7,8,2019-10-27,BUF,,PHI,L 13-31,*,16,34,47.1,169,2,0,5.0,6.15,81.6,4,14,8,45,0,5.6,0,0,0,,0,,,0.0,0,0,0,0,0,0,3,1,0,1,0,0,59,95.2,0,0.0,0,0.0
20,20,8,9,2019-11-03,BUF,,WAS,W 24-9,*,14,20,70.0,160,1,0,8.0,9.00,110.4,2,14,8,12,1,1.5,0,0,0,,0,,,0.0,0,0,0,0,0,0,2,0,0,1,0,0,62,100.0,0,0.0,0,0.0
21,21,9,10,2019-11-10,BUF,@,CLE,L 16-19,*,22,41,53.7,266,0,0,6.5,6.49,73.8,1,6,6,28,2,4.7,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,68,100.0,0,0.0,0,0.0
22,22,10,11,2019-11-17,BUF,@,MIA,W 37-20,*,21,33,63.6,256,3,0,7.8,9.58,117.7,0,0,7,56,1,8.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,71,100.0,0,0.0,0,0.0
23,23,11,12,2019-11-24,BUF,,DEN,W 20-3,*,15,25,60.0,185,2,1,7.4,7.20,92.9,1,5,9,56,0,6.2,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,74,100.0,0,0.0,0,0.0
24,24,12,13,2019-11-28,BUF,@,DAL,W 26-15,*,19,24,79.2,231,1,0,9.6,10.46,120.7,4,27,10,43,1,4.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,1,0,0,66,100.0,0,0.0,0,0.0
25,25,13,14,2019-12-08,BUF,,BAL,L 17-24,*,17,39,43.6,146,1,0,3.7,4.26,62.6,6,41,2,9,0,4.5,0,0,0,,0,,,0.0,0,0,0,0,0,0,2,1,0,0,0,0,73,100.0,0,0.0,0,0.0
26,26,14,15,2019-12-15,BUF,@,PIT,W 17-10,*,13,25,52.0,139,1,1,5.6,4.56,65.2,1,8,7,28,1,4.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,65,100.0,0,0.0,0,0.0
27,27,15,16,2019-12-21,BUF,@,NWE,L 17-24,*,13,26,50.0,208,2,0,8.0,9.54,102.7,4,32,7,43,0,6.1,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,54,100.0,0,0.0,0,0.0
28,28,16,17,2019-12-29,BUF,,NYJ,L 6-13,*,3,5,60.0,5,0,0,1.0,1.00,64.6,0,0,0,0,0,,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,7,10.9,0,0.0,0,0.0
29,29,1,1,2020-09-13,BUF,,NYJ,W 27-17,*,33,46,71.7,312,2,0,6.8,7.65,104.6,3,6,14,57,1,4.1,0,0,0,,0,,,0.0,0,0,0,0,0,0,2,2,0,0,0,0,87,100.0,0,0.0,0,0.0
30,30,2,2,2020-09-20,BUF,@,MIA,W 31-28,*,24,35,68.6,415,4,0,11.9,14.14,146.7,1,4,4,19,0,4.8,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,61,100.0,0,0.0,0,0.0
31,31,3,3,2020-09-27,BUF,,LAR,W 35-32,*,24,33,72.7,311,4,1,9.4,10.48,128.9,4,37,4,8,1,2.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,62,100.0,0,0.0,0,0.0
32,32,4,4,2020-10-04,BUF,@,LVR,W 30-23,*,24,34,70.6,288,2,0,8.5,9.65,115.8,1,14,3,-1,1,-0.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,61,100.0,0,0.0,0,0.0
33,33,5,5,2020-10-13,BUF,@,TEN,L 16-42,*,26,41,63.4,263,2,2,6.4,5.20,77.6,1,10,4,18,0,4.5,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,65,90.3,0,0.0,0,0.0
34,34,6,6,2020-10-19,BUF,,KAN,L 17-26,*,14,27,51.9,122,2,1,4.5,4.33,73.4,0,0,8,42,0,5.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,53,100.0,0,0.0,0,0.0
35,35,7,7,2020-10-25,BUF,@,NYJ,W 18-10,*,30,43,69.8,307,0,0,7.1,7.14,90.0,2,11,11,61,0,5.5,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,74,100.0,0,0.0,0,0.0
36,36,8,8,2020-11-01,BUF,,NWE,W 24-21,*,11,18,61.1,154,0,1,8.6,6.06,65.5,1,5,10,23,1,2.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,58,100.0,0,0.0,0,0.0
37,37,9,9,2020-11-08,BUF,,SEA,W 44-34,*,31,38,81.6,415,3,0,10.9,12.50,138.5,7,29,7,14,1,2.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,68,100.0,0,0.0,0,0.0
38,38,10,10,2020-11-15,BUF,@,ARI,L 30-32,*,32,49,65.3,284,2,2,5.8,4.78,77.3,0,0,7,38,0,5.4,1,1,12,12.0,1,100.0,12.0,0.0,0,0,0,0,0,0,0,0,0,0,0,0,73,100.0,0,0.0,0,0.0
39,39,11,12,2020-11-29,BUF,,LAC,W 27-17,*,18,24,75.0,157,1,1,6.5,5.50,88.4,2,10,9,32,1,3.6,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,1,0,0,-2,0,61,98.4,0,0.0,0,0.0
40,40,12,13,2020-12-07,BUF,@,SFO,W 34-24,*,32,40,80.0,375,4,0,9.4,11.38,139.1,1,7,6,11,0,1.8,0,0,0,,0,,,0.0,0,0,0,0,0,0,2,1,0,0,0,0,73,100.0,0,0.0,0,0.0
41,41,13,14,2020-12-13,BUF,,PIT,W 26-15,*,24,43,55.8,238,2,1,5.5,5.42,77.5,1,8,6,28,0,4.7,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,75,100.0,0,0.0,0,0.0
42,42,14,15,2020-12-19,BUF,@,DEN,W 48-19,*,28,40,70.0,359,2,0,9.0,9.98,114.5,1,7,3,33,2,11.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,1,0,0,72,98.6,0,0.0,0,0.0
43,43,15,16,2020-12-28,BUF,@,NWE,W 38-9,*,27,36,75.0,320,4,0,8.9,11.11,138.7,0,0,4,35,0,8.8,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,57,79.2,0,0.0,0,0.0
44,44,16,17,2021-01-03,BUF,,MIA,W 56-26,*,18,25,72.0,224,3,1,9.0,9.56,122.3,1,11,2,3,0,1.5,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,35,54.7,0,0.0,0,0.0
45,45,1,1,2021-09-12,BUF,,PIT,L 16-23,*,30,51,58.8,270,1,0,5.3,5.69,79.7,3,16,9,44,0,4.9,0,0,0,,0,,,0.0,0,0,0,0,0,0,2,1,0,1,0,0,85,100.0,0,0.0,0,0.0
46,46,2,2,2021-09-19,BUF,@,MIA,W 35-0,*,17,33,51.5,179,2,1,5.4,5.27,75.2,1,8,5,35,0,7.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,63,96.9,0,0.0,0,0.0
47,47,3,3,2021-09-26,BUF,,WAS,W 43-21,*,32,43,74.4,358,4,0,8.3,10.19,129.8,0,0,4,9,1,2.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,71,89.9,0,0.0,0,0.0
48,48,4,4,2021-10-03,BUF,,HOU,W 40-0,*,20,30,66.7,248,2,1,8.3,8.10,100.4,1,5,6,41,0,6.8,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,1,-2,0,63,87.5,0,0.0,0,0.0
49,49,5,5,2021-10-10,BUF,@,KAN,W 38-20,*,15,26,57.7,315,3,0,12.1,14.42,139.1,0,0,11,59,1,5.4,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,57,100.0,0,0.0,0,0.0
50,50,6,6,2021-10-18,BUF,@,TEN,L 31-34,*,35,47,74.5,353,3,1,7.5,7.83,107.8,3,18,9,26,0,2.9,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,77,100.0,0,0.0,0,0.0
51,51,7,8,2021-10-31,BUF,,MIA,W 26-11,*,29,42,69.0,249,2,0,5.9,6.88,100.2,0,0,8,55,1,6.9,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,73,100.0,0,0.0,0,0.0
52,52,8,9,2021-11-07,BUF,@,JAX,L 6-9,*,31,47,66.0,264,0,2,5.6,3.70,62.7,4,35,5,50,0,10.0,0,0,0,,0,,,0.0,1,1,0,0,0,0,1,1,0,0,0,0,67,100.0,0,0.0,0,0.0
53,53,9,10,2021-11-14,BUF,@,NYJ,W 45-17,*,21,28,75.0,366,2,1,13.1,12.89,125.6,2,16,2,3,0,1.5,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,54,93.1,0,0.0,0,0.0
54,54,10,11,2021-11-21,BUF,,IND,L 15-41,*,21,35,60.0,209,2,2,6.0,4.54,72.2,1,8,2,18,0,9.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,50,89.3,0,0.0,0,0.0
55,55,11,12,2021-11-25,BUF,@,NOR,W 31-6,*,23,28,82.1,260,4,2,9.3,8.93,115.2,2,12,8,43,0,5.4,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,63,95.5,0,0.0,0,0.0
56,56,12,13,2021-12-06,BUF,,NWE,L 10-14,*,15,30,50.0,145,1,0,4.8,5.50,75.0,2,14,6,39,0,6.5,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,1,0,0,-2,0,58,100.0,0,0.0,0,0.0
57,57,13,14,2021-12-12,BUF,@,TAM,L 27-33 (OT),*,36,54,66.7,308,2,1,5.7,5.61,86.0,3,15,12,109,1,9.1,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,78,100.0,0,0.0,0,0.0
58,58,14,15,2021-12-19,BUF,,CAR,W 31-14,*,19,34,55.9,210,3,1,6.2,6.62,91.5,4,17,3,24,0,8.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,70,100.0,0,0.0,0,0.0
59,59,15,16,2021-12-26,BUF,@,NWE,W 33-21,*,30,47,63.8,314,3,0,6.7,7.96,104.4,0,0,12,64,0,5.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,79,100.0,0,0.0,0,0.0
60,60,16,17,2022-01-02,BUF,,ATL,W 29-15,*,11,26,42.3,120,0,3,4.6,-0.58,17.0,0,0,15,81,2,5.4,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,76,100.0,0,0.0,0,0.0
61,61,17,18,2022-01-09,BUF,,NYJ,W 27-10,*,24,45,53.3,239,2,0,5.3,6.20,83.5,0,0,5,63,0,12.6,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,77,93.9,0,0.0,0,0.0
62,62,1,1,2022-09-08,BUF,@,LAR,W 31-10,*,26,31,83.9,297,3,2,9.6,8.61,112.0,2,5,10,56,1,5.6,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,59,100.0,0,0.0,0,0.0
63,63,2,2,2022-09-19,BUF,,TEN,W 41-7,*,26,38,68.4,317,4,0,8.3,10.45,128.9,1,4,1,10,0,10.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,52,76.5,0,0.0,0,0.0
64,64,3,3,2022-09-25,BUF,@,MIA,L 19-21,*,42,63,66.7,400,2,0,6.3,6.98,94.7,4,18,8,47,0,5.9,0,0,0,,0,,,0.0,0,0,0,0,0,0,3,1,0,1,-1,0,92,100.0,0,0.0,0,0.0
65,65,4,4,2022-10-02,BUF,@,BAL,W 23-20,*,19,36,52.8,213,1,1,5.9,5.22,68.4,1,12,11,70,1,6.4,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,1,0,0,64,100.0,0,0.0,0,0.0
66,66,5,5,2022-10-09,BUF,,PIT,W 38-3,*,20,31,64.5,424,4,1,13.7,14.81,134.1,0,0,5,42,0,8.4,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,48,85.7,0,0.0,0,0.0
67,67,6,6,2022-10-16,BUF,@,KAN,W 24-20,*,27,40,67.5,329,3,0,8.2,9.73,117.6,1,11,12,32,0,2.7,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,73,100.0,0,0.0,0,0.0
68,68,7,8,2022-10-30,BUF,,GNB,W 27-17,*,13,25,52.0,218,2,2,8.7,6.72,75.1,2,2,6,49,0,8.2,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,59,100.0,0,0.0,0,0.0
69,69,8,9,2022-11-06,BUF,@,NYJ,L 17-20,*,18,34,52.9,205,0,2,6.0,3.38,46.8,5,22,9,86,2,9.6,0,0,0,,0,,,0.0,0,0,0,0,0,0,2,0,0,1,0,0,62,100.0,0,0.0,0,0.0
70,70,9,10,2022-11-13,BUF,,MIN,L 30-33 (OT),*,29,43,67.4,330,1,2,7.7,6.05,78.6,2,19,6,84,0,14.0,0,0,0,,0,,,0.0,2,2,0,0,0,0,1,1,0,0,-1,0,75,100.0,0,0.0,0,0.0
71,71,10,11,2022-11-20,BUF,,CLE,W 31-23,*,18,27,66.7,197,1,0,7.3,8.04,100.4,2,11,3,7,0,2.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,65,100.0,0,0.0,0,0.0
72,72,11,12,2022-11-24,BUF,@,DET,W 28-25,*,24,42,57.1,253,2,1,6.0,5.90,80.8,3,16,10,78,1,7.8,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,1,0,0,77,100.0,0,0.0,0,0.0
73,73,12,13,2022-12-01,BUF,@,NWE,W 24-10,*,22,33,66.7,223,2,0,6.8,7.97,106.0,2,0,8,20,0,2.5,0,0,0,,0,,,0.0,1,1,0,0,0,0,1,1,0,0,0,0,75,100.0,0,0.0,0,0.0
74,74,13,14,2022-12-11,BUF,,NYJ,W 20-12,*,16,27,59.3,147,1,0,5.4,6.19,86.5,3,17,10,47,1,4.7,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,59,100.0,0,0.0,0,0.0
75,75,14,15,2022-12-17,BUF,,MIA,W 32-29,*,25,40,62.5,304,4,0,7.6,9.60,119.2,2,8,10,77,0,7.7,0,0,0,,0,,,0.0,0,0,0,0,0,0,2,1,0,0,0,0,78,100.0,0,0.0,0,0.0
76,76,15,16,2022-12-24,BUF,@,CHI,W 35-13,*,15,26,57.7,172,2,2,6.6,4.69,71.3,1,0,6,41,1,6.8,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,1,0,0,64,100.0,0,0.0,0,0.0
77,77,16,18,2023-01-08,BUF,,NWE,W 35-23,*,19,31,61.3,254,3,1,8.2,8.68,106.1,2,17,9,16,0,1.8,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,59,100.0,0,0.0,0,0.0
78,78,1,1,2023-09-11,BUF,@,NYJ,L 16-22 (OT),*,29,41,70.7,236,1,3,5.8,2.95,62.7,5,19,6,36,0,6.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,2,1,0,1,0,0,69,100.0,0,0.0,0,0.0
79,79,2,2,2023-09-17,BUF,,LVR,W 38-10,*,31,37,83.8,274,3,0,7.4,9.03,124.5,2,7,3,7,0,2.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,74,94.9,0,0.0,0,0.0
80,80,3,3,2023-09-24,BUF,@,WAS,W 37-3,*,20,32,62.5,218,1,1,6.8,6.03,79.9,0,0,3,46,1,15.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,57,83.8,0,0.0,0,0.0
81,81,4,4,2023-10-01,BUF,,MIA,W 48-20,*,21,25,84.0,320,4,0,12.8,16.00,158.3,2,10,4,17,1,4.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,50,86.2,0,0.0,0,0.0
82,82,5,5,2023-10-08,BUF,,JAX,L 20-25,*,27,40,67.5,359,2,1,9.0,8.85,102.0,0,0,4,14,1,3.5,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,60,100.0,0,0.0,0,0.0
83,83,6,6,2023-10-15,BUF,,NYG,W 14-9,*,19,30,63.3,169,2,1,5.6,5.47,86.7,0,0,2,11,0,5.5,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,59,96.7,0,0.0,0,0.0
84,84,7,7,2023-10-22,BUF,@,NWE,L 25-29,*,27,41,65.9,265,2,1,6.5,6.34,90.0,1,7,7,17,1,2.4,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,71,100.0,0,0.0,0,0.0
85,85,8,8,2023-10-26,BUF,,TAM,W 24-18,*,31,40,77.5,324,2,1,8.1,7.98,106.7,2,12,7,41,1,5.9,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,69,100.0,0,0.0,0,0.0
86,86,9,9,2023-11-05,BUF,@,CIN,L 18-24,*,26,38,68.4,258,1,1,6.8,6.13,85.2,1,9,8,44,1,5.5,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,58,100.0,0,0.0,0,0.0
87,87,10,10,2023-11-13,BUF,,DEN,L 22-24,*,15,26,57.7,177,1,2,6.8,4.12,59.3,0,0,4,13,1,3.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,1,0,0,-4,0,54,100.0,0,0.0,0,0.0
88,88,11,11,2023-11-19,BUF,,NYJ,W 32-6,*,20,32,62.5,275,3,1,8.6,9.06,108.2,1,12,5,15,0,3.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,72,94.7,0,0.0,0,0.0
89,89,12,12,2023-11-26,BUF,@,PHI,L 34-37 (OT),*,29,51,56.9,339,2,1,6.6,6.55,82.1,1,7,9,81,2,9.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,95,100.0,0,0.0,0,0.0
90,90,13,14,2023-12-10,BUF,@,KAN,W 20-17,*,23,42,54.8,233,1,1,5.5,4.95,68.8,3,24,10,32,1,3.2,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,77,100.0,0,0.0,0,0.0
91,91,14,15,2023-12-17,BUF,,DAL,W 31-10,*,7,15,46.7,94,1,0,6.3,7.60,89.3,1,9,8,24,1,3.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,61,89.7,0,0.0,0,0.0
92,92,15,16,2023-12-23,BUF,@,LAC,W 24-22,*,15,21,71.4,237,1,1,11.3,10.10,104.7,1,7,5,15,2,3.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,55,100.0,0,0.0,0,0.0
93,93,16,17,2023-12-31,BUF,,NWE,W 27-21,*,15,30,50.0,169,0,1,5.6,4.13,53.3,1,15,11,44,2,4.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,2,0,0,0,0,0,67,97.1,0,0.0,0,0.0
94,94,17,18,2024-01-07,BUF,@,MIA,W 21-14,*,30,38,78.9,359,2,2,9.4,8.13,101.6,3,14,15,67,0,4.5,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,78,100.0,0,0.0,0,0.0
95,95,1,1,2024-09-08,BUF,,ARI,W 34-28,*,18,23,78.3,232,2,0,10.1,11.83,137.7,2,10,9,39,2,4.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,62,100.0,0,0.0,0,0.0
96,96,2,2,2024-09-12,BUF,@,MIA,W 31-10,*,13,19,68.4,139,1,0,7.3,8.37,107.1,0,0,2,2,0,1.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,1,0,0,41,91.1,0,0.0,0,0.0
97,97,3,3,2024-09-23,BUF,,JAX,W 47-10,*,23,30,76.7,263,4,0,8.8,11.43,142.1,0,0,6,44,0,7.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,56,87.5,0,0.0,0,0.0
98,98,4,4,2024-09-29,BUF,@,BAL,L 10-35,*,16,29,55.2,180,0,0,6.2,6.21,73.9,3,27,5,21,0,4.2,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,51,86.4,0,0.0,0,0.0
99,99,5,5,2024-10-06,BUF,@,HOU,L 20-23,*,9,30,30.0,131,1,0,4.4,5.03,56.4,1,5,4,54,0,13.5,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,60,98.4,0,0.0,0,0.0
100,100,6,6,2024-10-14,BUF,@,NYJ,W 23-20,*,19,25,76.0,215,2,0,8.6,10.20,127.9,2,5,9,18,1,2.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,69,100.0,0,0.0,0,0.0
101,101,7,7,2024-10-20,BUF,,TEN,W 34-10,*,21,33,63.6,323,2,0,9.8,11.00,116.1,1,8,3,1,0,0.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,55,100.0,0,0.0,0,0.0
102,102,8,8,2024-10-27,BUF,@,SEA,W 31-10,*,24,34,70.6,283,2,1,8.3,8.18,102.9,1,2,7,25,0,3.6,0,0,0,,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,69,90.8,0,0.0,0,0.0
103,103,9,9,2024-11-03,BUF,,MIA,W 30-27,*,25,39,64.1,235,3,1,6.0,6.41,95.6,1,4,2,7,0,3.5,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,66,100.0,0,0.0,0,0.0
104,104,10,10,2024-11-10,BUF,@,IND,W 30-20,*,22,37,59.5,280,0,2,7.6,5.14,60.6,2,0,8,50,1,6.3,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,73,98.6,0,0.0,0,0.0
105,105,11,11,2024-11-17,BUF,,KAN,W 30-21,*,27,40,67.5,262,1,1,6.6,5.93,83.5,0,0,12,55,1,4.6,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,73,100.0,0,0.0,0,0.0
106,106,12,13,2024-12-01,BUF,,SFO,W 35-10,*,13,17,76.5,148,2,0,8.7,11.06,141.3,0,0,3,18,1,6.0,0,0,7,,1,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,43,74.1,0,0.0,0,0.0
107,107,13,14,2024-12-08,BUF,@,LAR,L 42-44,*,22,37,59.5,342,3,0,9.2,10.86,117.2,0,0,10,82,3,8.2,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,60,100.0,0,0.0,0,0.0
108,108,14,15,2024-12-15,BUF,@,DET,W 48-42,*,23,34,67.6,362,2,0,10.6,11.82,122.4,0,0,11,68,2,6.2,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,70,100.0,0,0.0,0,0.0
109,109,15,16,2024-12-22,BUF,,NWE,W 24-21,*,16,29,55.2,154,1,1,5.3,4.45,67.3,1,2,6,30,0,5.0,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,59,100.0,0,0.0,0,0.0
110,110,16,17,2024-12-29,BUF,,NYJ,W 40-14,*,16,27,59.3,182,2,0,6.7,8.22,104.2,0,0,5,17,1,3.4,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,60,85.7,0,0.0,0,0.0
111,111,17,18,2025-01-05,BUF,@,NWE,L 16-23,*,0,0,,0,0,0,,,,0,0,0,0,0,,0,0,0,,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,1,1.5,0,0.0,0,0.0
,,,,,,,,76-35,,2296,3628,63.3,26434,195,84,7.3,7.32,93.4,189,1150,759,4142,65,5.5,2,1,19,19.0,2,50.0,9.5,0.0,4,4,0,0,0,0,64,26,0,16,-27,0,7058,94.5,0,0.0,0,0.0'''

# Convert to DataFrame, skip the first row/headers
df = pd.read_csv(io.StringIO(raw_data), skiprows=1)

# Select essential columns
columns_to_keep = ['Rk', 'Gcar', 'Gtm', 'Week', 'Date', 'Team', 'Opp', 'GS', 'Cmp', 'Att', 
                   'Cmp%', 'Yds', 'TD', 'Int', 'Y/A', 'AY/A', 'Rate', 'Sk', 'Yds.1', 
                   'Att.1', 'Yds.2', 'TD.1', 'Y/A.1', 'Fmb']

#Keep only essential columns and rename for clarity
df_clean = df[columns_to_keep].copy()
df_clean.columns = ['Rank', 'Game_Career', 'Game_Team', 'Week', 'Date', 'Team', 'Opponent', 'GS',
                    'Completions', 'Attempts', 'Completion_Pct', 'Pass_Yds', 'Pass_TD', 'INT',
                    'Yards_per_Attempt', 'Adj_Yards_per_Attempt', 'Passer_Rating', 'Sacks',
                    'Sack_Yards', 'Rush_Att', 'Rush_Yds', 'Rush_TD', 'Yards_per_Rush', 'Fumbles']
df_clean = df_clean[pd.to_numeric(df_clean['Week'], errors='coerce').notna()]

# Convert numeric columns to proper types
numeric_cols = ['Rank', 'Game_Career', 'Game_Team', 'Week', 'Completions', 'Attempts', 
                'Completion_Pct', 'Pass_Yds', 'Pass_TD', 'INT', 'Yards_per_Attempt',
                'Adj_Yards_per_Attempt', 'Passer_Rating', 'Sacks', 'Sack_Yards',
                'Rush_Att', 'Rush_Yds', 'Rush_TD', 'Yards_per_Rush', 'Fumbles']

for col in numeric_cols:
    df_clean[col] = pd.to_numeric(df_clean[col], errors='coerce')

# Calculate fantasy points (PPR scoring)
df_clean['Fantasy_Points'] = (
    (df_clean['Pass_Yds'] / 25) + 
    (df_clean['Pass_TD'] * 4) + 
    (df_clean['Rush_Yds'] / 10) + 
    (df_clean['Rush_TD'] * 6) - 
    (df_clean['INT'] * 2) - 
    (df_clean['Fumbles'] * 2)
)

# Clean team abbreviations to current formats
team_map = {
    "SFO": "SF",
    "NWE": "NE",
    "LVR": "LV",
    "OAK": "LV",
    "TAM": "TB",
    "NOR": "NO",
    "GNB": "GB",
    "KAN": "KC",
}
df_clean['Opponent'] = df_clean['Opponent'].replace(team_map)
df_clean['Team'] = df_clean['Team'].replace(team_map)

# Add Season column
df_clean['Date'] = pd.to_datetime(df_clean['Date'], errors='coerce')
df_clean['Season'] = df_clean['Date'].dt.year

# Add QB name
df_clean['QB'] = qb_name

# Save cleaned data to CSV
filename = f"data/{qb_name.lower().replace(' ', '_')}_complete_game_logs.csv"
df_clean.to_csv(filename, index=False)
print(f"saved {len(df_clean)} games to {filename}")