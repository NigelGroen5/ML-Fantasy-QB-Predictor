'''
This file is a template to clean any QB's data from Pro-Football-Reference.com.
Just replace the QB name and raw_data variables
'''


import pandas as pd
import io
import numpy as np

# SET THESE VARIABLES FOR EACH QB
qb_name = "Lamar Jackson"
raw_data = ''',,,,,,,,,,Passing,Passing,Passing,Passing,Passing,Passing,Passing,Passing,Passing,Passing,Passing,Rushing,Rushing,Rushing,Rushing,Receiving,Receiving,Receiving,Receiving,Receiving,Receiving,,Tackles,Tackles,Tackles,Tackles,Tackles,,Fumbles,Fumbles,Fumbles,Fumbles,Fumbles,Fumbles,Snap Counts,Snap Counts,Snap Counts,Snap Counts,Snap Counts,Snap Counts
Rk,Gcar,Gtm,Week,Date,Team,,Opp,Result,GS,Cmp,Att,Cmp%,Yds,TD,Int,Y/A,AY/A,Rate,Sk,Yds,Att,Yds,TD,Y/A,Tgt,Rec,Yds,TD,Ctch%,Y/Tgt,Sk,Comb,Solo,Ast,TFL,QBHits,Sfty,Fmb,FL,FF,FR,Yds,FRTD,OffSnp,Off%,DefSnp,Def%,STSnp,ST%
1,1,1,1,2018-09-09,BAL,,BUF,W 47-3,,1,4,25.0,24,0,0,6.0,6.00,52.1,1,8,7,39,0,5.6,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,1,-1,0,30,37.5,0,0.0,0,0.0
2,2,2,2,2018-09-13,BAL,@,CIN,L 23-34,,0,0,,0,0,0,,,,0,0,2,6,0,3.0,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,6,7.1,0,0.0,0,0.0
3,3,3,3,2018-09-23,BAL,,DEN,W 27-14,,0,0,,0,0,0,,,,0,0,0,0,0,,1,0,0,0,0.0,0.0,0.0,0,0,0,0,0,0,0,0,0,0,0,0,2,2.8,0,0.0,0,0.0
4,4,4,4,2018-09-30,BAL,@,PIT,W 26-14,,0,0,,0,0,0,,,,0,0,4,17,0,4.3,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,9,11.8,0,0.0,0,0.0
5,5,5,5,2018-10-07,BAL,@,CLE,L 9-12 (OT),,0,1,0.0,0,0,0,0.0,0.00,39.6,0,0,3,10,0,3.3,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,5,5.7,0,0.0,0,0.0
6,6,6,6,2018-10-14,BAL,@,TEN,W 21-0,,0,0,,0,0,0,,,,0,0,1,22,0,22.0,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,2,2.6,0,0.0,0,0.0
7,7,7,7,2018-10-21,BAL,,NOR,L 23-24,,1,1,100.0,5,0,0,5.0,5.00,87.5,0,0,3,9,1,3.0,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,5,7.4,0,0.0,0,0.0
8,8,8,8,2018-10-28,BAL,@,CAR,L 21-36,,4,5,80.0,46,1,0,9.2,13.20,144.6,0,0,3,26,0,8.7,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,14,20.6,0,0.0,0,0.0
9,9,9,9,2018-11-04,BAL,,PIT,L 16-23,,1,1,100.0,12,0,0,12.0,12.00,116.7,0,0,5,10,0,2.0,1,0,0,0,0.0,0.0,0.0,0,0,0,0,0,0,1,0,0,0,-3,0,13,21.3,0,0.0,0,0.0
10,10,10,11,2018-11-18,BAL,,CIN,W 24-21,*,13,19,68.4,150,0,1,7.9,5.53,70.1,3,14,26,119,0,4.6,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,1,-3,0,79,100.0,0,0.0,0,0.0
11,11,11,12,2018-11-25,BAL,,OAK,W 34-17,*,14,25,56.0,178,1,2,7.1,4.32,58.4,1,4,11,71,1,6.5,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,1,-2,0,70,100.0,0,0.0,0,0.0
12,12,12,13,2018-12-02,BAL,@,ATL,W 26-16,*,12,21,57.1,125,0,0,6.0,5.95,74.5,2,8,17,75,1,4.4,0,0,0,0,,,0.0,0,0,0,0,0,0,3,1,0,1,0,0,66,81.5,0,0.0,0,0.0
13,13,13,14,2018-12-09,BAL,@,KAN,L 24-27 (OT),*,13,24,54.2,147,2,0,6.1,7.79,100.5,2,20,14,67,0,4.8,0,0,0,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,69,97.2,0,0.0,0,0.0
14,14,14,15,2018-12-16,BAL,,TAM,W 20-12,*,14,23,60.9,131,1,0,5.7,6.57,91.0,2,3,18,95,0,5.3,0,0,0,0,,,0.0,0,0,0,0,0,0,1,1,0,0,-6,0,76,100.0,0,0.0,0,0.0
15,15,15,16,2018-12-22,BAL,@,LAC,W 22-10,*,12,22,54.5,204,1,0,9.3,10.18,101.3,3,2,13,39,0,3.0,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,1,0,0,62,100.0,0,0.0,0,0.0
16,16,16,17,2018-12-30,BAL,,CLE,W 26-24,*,14,24,58.3,179,0,0,7.5,7.46,81.8,2,12,20,90,2,4.5,0,0,0,0,,,0.0,0,0,0,0,0,0,2,1,0,0,-6,0,77,100.0,0,0.0,0,0.0
17,17,1,1,2019-09-08,BAL,@,MIA,W 59-10,*,17,20,85.0,324,5,0,16.2,21.20,158.3,1,1,3,6,0,2.0,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,53,69.7,0,0.0,0,0.0
18,18,2,2,2019-09-15,BAL,,ARI,W 23-17,*,24,37,64.9,272,2,0,7.4,8.43,104.8,2,14,16,120,0,7.5,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,77,100.0,0,0.0,0,0.0
19,19,3,3,2019-09-22,BAL,@,KAN,L 28-33,*,22,43,51.2,267,0,0,6.2,6.21,70.6,3,18,8,46,1,5.8,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,82,100.0,0,0.0,0,0.0
20,20,4,4,2019-09-29,BAL,,CLE,L 25-40,*,24,34,70.6,247,3,2,7.3,6.38,96.1,4,25,9,66,0,7.3,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,0,-3,0,69,100.0,0,0.0,0,0.0
21,21,5,5,2019-10-06,BAL,@,PIT,W 26-23 (OT),*,19,28,67.9,161,1,3,5.8,1.64,54.9,5,22,14,70,0,5.0,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,1,0,0,79,100.0,0,0.0,0,0.0
22,22,6,6,2019-10-13,BAL,,CIN,W 23-17,*,21,33,63.6,236,0,0,7.2,7.15,84.9,1,8,19,152,1,8.0,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,79,100.0,0,0.0,0,0.0
23,23,7,7,2019-10-20,BAL,@,SEA,W 30-16,*,9,20,45.0,143,0,0,7.2,7.15,69.4,1,2,14,116,1,8.3,0,0,0,0,,,0.0,0,0,0,0,0,0,2,0,0,0,0,0,58,100.0,0,0.0,0,0.0
24,24,8,9,2019-11-03,BAL,,NWE,W 37-20,*,17,23,73.9,163,1,0,7.1,7.96,107.7,1,1,16,61,2,3.8,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,67,100.0,0,0.0,0,0.0
25,25,9,10,2019-11-10,BAL,@,CIN,W 49-13,*,15,17,88.2,223,3,0,13.1,16.65,158.3,0,0,7,65,1,9.3,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,35,76.1,0,0.0,0,0.0
26,26,10,11,2019-11-17,BAL,,HOU,W 41-7,*,17,24,70.8,222,4,0,9.3,12.58,139.2,0,0,10,79,0,7.9,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,58,86.6,0,0.0,0,0.0
27,27,11,12,2019-11-25,BAL,@,LAR,W 45-6,*,15,20,75.0,169,5,0,8.5,13.45,139.4,2,9,8,95,0,11.9,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,1,0,0,61,79.2,0,0.0,0,0.0
28,28,12,13,2019-12-01,BAL,,SFO,W 20-17,*,14,23,60.9,105,1,0,4.6,5.43,86.3,1,0,16,101,1,6.3,0,0,0,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,65,100.0,0,0.0,0,0.0
29,29,13,14,2019-12-08,BAL,@,BUF,W 24-17,*,16,25,64.0,145,3,1,5.8,6.40,102.5,1,6,11,40,0,3.6,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,60,100.0,0,0.0,0,0.0
30,30,14,15,2019-12-12,BAL,,NYJ,W 42-21,*,15,23,65.2,212,5,0,9.2,13.57,134.4,1,0,8,86,0,10.8,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,1,0,0,53,85.5,0,0.0,0,0.0
31,31,15,16,2019-12-22,BAL,@,CLE,W 31-15,*,20,31,64.5,238,3,0,7.7,9.61,120.1,0,0,17,103,0,6.1,0,0,0,0,,,0.0,0,0,0,0,0,0,2,1,0,1,0,0,73,100.0,0,0.0,0,0.0
32,32,1,1,2020-09-13,BAL,,CLE,W 38-6,*,20,25,80.0,275,3,0,11.0,13.40,152.1,2,14,7,45,0,6.4,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,53,89.8,0,0.0,0,0.0
33,33,2,2,2020-09-20,BAL,@,HOU,W 33-16,*,18,24,75.0,204,1,0,8.5,9.33,113.9,4,27,16,54,0,3.4,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,65,100.0,0,0.0,0,0.0
34,34,3,3,2020-09-28,BAL,,KAN,L 20-34,*,15,28,53.6,97,1,0,3.5,4.18,73.1,4,27,9,83,0,9.2,0,0,0,0,,,0.0,0,0,0,0,0,0,2,1,0,0,0,0,56,100.0,0,0.0,0,0.0
35,35,4,4,2020-10-04,BAL,@,WAS,W 31-17,*,14,21,66.7,193,2,1,9.2,8.95,107.8,1,2,7,53,1,7.6,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,47,82.5,0,0.0,0,0.0
36,36,5,5,2020-10-11,BAL,,CIN,W 27-3,*,19,37,51.4,180,2,1,4.9,4.73,71.9,1,9,2,3,0,1.5,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,62,98.4,0,0.0,0,0.0
37,37,6,6,2020-10-18,BAL,@,PHI,W 30-28,*,16,27,59.3,186,1,0,6.9,7.63,92.5,3,13,9,108,1,12.0,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,73,100.0,0,0.0,0,0.0
38,38,7,8,2020-11-01,BAL,,PIT,L 24-28,*,13,28,46.4,208,2,2,7.4,5.64,65.8,4,16,16,65,0,4.1,0,0,0,0,,,0.0,0,0,0,0,0,0,3,2,0,1,0,0,82,100.0,0,0.0,0,0.0
39,39,8,9,2020-11-08,BAL,@,IND,W 24-10,*,19,23,82.6,170,0,0,7.4,7.39,97.5,2,14,13,58,1,4.5,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,64,100.0,0,0.0,0,0.0
40,40,9,10,2020-11-15,BAL,@,NWE,L 17-23,*,24,34,70.6,249,2,1,7.3,7.18,98.8,2,7,11,55,0,5.0,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,2,0,0,66,100.0,0,0.0,0,0.0
41,41,10,11,2020-11-22,BAL,,TEN,L 24-30 (OT),*,17,29,58.6,186,1,1,6.4,5.55,74.8,1,9,13,51,0,3.9,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,65,100.0,0,0.0,0,0.0
42,42,12,13,2020-12-08,BAL,,DAL,W 34-17,*,12,17,70.6,107,2,1,6.3,6.00,101.8,0,0,13,94,1,7.2,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,0,-8,0,55,100.0,0,0.0,0,0.0
43,43,13,14,2020-12-14,BAL,@,CLE,W 47-42,*,11,17,64.7,163,1,0,9.6,10.76,115.6,4,22,9,124,2,13.8,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,49,81.7,0,0.0,0,0.0
44,44,14,15,2020-12-20,BAL,,JAX,W 40-14,*,17,22,77.3,243,3,1,11.0,11.73,133.1,1,0,10,35,1,3.5,0,0,0,0,,,0.0,0,0,0,0,0,0,2,0,0,1,0,0,55,83.3,0,0.0,0,0.0
45,45,15,16,2020-12-27,BAL,,NYG,W 27-13,*,17,26,65.4,183,2,0,7.0,8.58,111.5,0,0,13,80,0,6.2,0,0,0,0,,,0.0,0,0,0,0,0,0,1,1,0,0,-1,0,68,100.0,0,0.0,0,0.0
46,46,16,17,2021-01-03,BAL,@,CIN,W 38-3,*,10,18,55.6,113,3,1,6.3,7.11,91.0,0,0,11,97,0,8.8,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,57,77.0,0,0.0,0,0.0
47,47,1,1,2021-09-13,BAL,@,LVR,L 27-33 (OT),*,19,30,63.3,235,1,0,7.8,8.50,98.6,3,18,12,86,0,7.2,0,0,0,0,,,0.0,0,0,0,0,0,0,3,2,0,1,4,0,68,100.0,0,0.0,0,0.0
48,48,2,2,2021-09-19,BAL,,KAN,W 36-35,*,18,26,69.2,239,1,2,9.2,6.50,78.8,1,9,16,107,2,6.7,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,76,100.0,0,0.0,0,0.0
49,49,3,3,2021-09-26,BAL,@,DET,W 19-17,*,16,31,51.6,287,1,1,9.3,8.45,81.0,4,16,7,58,0,8.3,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,1,5,0,58,100.0,0,0.0,0,0.0
50,50,4,4,2021-10-03,BAL,@,DEN,W 23-7,*,22,37,59.5,316,1,0,8.5,9.08,96.2,3,12,7,28,0,4.0,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,73,100.0,0,0.0,0,0.0
51,51,5,5,2021-10-11,BAL,,IND,W 31-25 (OT),*,37,43,86.0,442,4,0,10.3,12.14,140.5,2,5,14,62,0,4.4,0,0,0,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,73,100.0,0,0.0,0,0.0
52,52,6,6,2021-10-17,BAL,,LAC,W 34-6,*,19,27,70.4,167,1,2,6.2,3.59,68.0,3,27,8,51,0,6.4,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,65,94.2,0,0.0,0,0.0
53,53,7,7,2021-10-24,BAL,,CIN,L 17-41,*,15,31,48.4,257,1,0,8.3,8.94,87.7,5,18,12,88,0,7.3,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,61,83.6,0,0.0,0,0.0
54,54,8,9,2021-11-07,BAL,,MIN,W 34-31 (OT),*,27,41,65.9,266,3,2,6.5,5.76,88.1,3,13,21,120,0,5.7,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,98,100.0,0,0.0,0,0.0
55,55,9,10,2021-11-11,BAL,@,MIA,L 10-22,*,26,43,60.5,238,1,1,5.5,4.95,73.6,4,28,9,39,0,4.3,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,73,100.0,0,0.0,0,0.0
56,56,11,12,2021-11-28,BAL,,CLE,W 16-10,*,20,32,62.5,165,1,4,5.2,0.16,46.5,2,10,17,68,0,4.0,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,81,100.0,0,0.0,0,0.0
57,57,12,13,2021-12-05,BAL,@,PIT,L 19-20,*,23,37,62.2,253,1,1,6.8,6.16,80.1,7,34,8,55,0,6.9,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,74,100.0,0,0.0,0,0.0
58,58,13,14,2021-12-12,BAL,@,CLE,L 22-24,*,4,4,100.0,17,0,0,4.3,4.25,84.4,1,0,2,5,0,2.5,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,10,13.5,0,0.0,0,0.0
59,59,1,1,2022-09-11,BAL,@,NYJ,W 24-9,*,17,30,56.7,213,3,1,7.1,7.60,98.3,2,2,6,17,0,2.8,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,56,100.0,0,0.0,0,0.0
60,60,2,2,2022-09-18,BAL,,MIA,L 38-42,*,21,29,72.4,318,3,0,11.0,13.03,142.6,0,0,9,119,1,13.2,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,0,-5,0,59,100.0,0,0.0,0,0.0
61,61,3,3,2022-09-25,BAL,@,NWE,W 37-26,*,18,29,62.1,218,4,1,7.5,8.72,110.3,4,12,11,107,1,9.7,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,60,100.0,0,0.0,0,0.0
62,62,4,4,2022-10-02,BAL,,BUF,L 20-23,*,20,29,69.0,144,1,2,5.0,2.55,63.0,2,10,11,73,0,6.6,0,0,0,0,,,0.0,1,1,0,0,0,0,0,0,0,0,0,0,70,100.0,0,0.0,0,0.0
63,63,5,5,2022-10-09,BAL,,CIN,W 19-17,*,19,32,59.4,174,1,1,5.4,4.66,71.6,1,4,12,58,0,4.8,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,65,100.0,0,0.0,0,0.0
64,64,6,6,2022-10-16,BAL,@,NYG,L 20-24,*,17,32,53.1,210,1,1,6.6,5.78,71.1,2,15,7,77,0,11.0,0,0,0,0,,,0.0,0,0,0,0,0,0,2,1,0,1,0,0,59,100.0,0,0.0,0,0.0
65,65,7,7,2022-10-23,BAL,,CLE,W 23-20,*,9,16,56.3,120,0,0,7.5,7.50,80.2,3,26,10,59,0,5.9,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,64,100.0,0,0.0,0,0.0
66,66,8,8,2022-10-27,BAL,@,TAM,W 27-22,*,27,38,71.1,238,2,0,6.3,7.32,104.9,3,16,9,43,0,4.8,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,76,100.0,0,0.0,0,0.0
67,67,9,9,2022-11-07,BAL,@,NOR,W 27-13,*,12,22,54.5,133,1,0,6.0,6.95,87.9,3,2,11,82,0,7.5,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,1,0,0,68,100.0,0,0.0,0,0.0
68,68,10,11,2022-11-20,BAL,,CAR,W 13-3,*,24,33,72.7,209,0,1,6.3,4.97,76.5,3,16,11,31,1,2.8,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,69,100.0,0,0.0,0,0.0
69,69,11,12,2022-11-27,BAL,@,JAX,L 27-28,*,16,32,50.0,254,1,0,7.9,8.56,87.2,1,1,14,89,0,6.4,0,0,0,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,72,100.0,0,0.0,0,0.0
70,70,12,13,2022-12-04,BAL,,DEN,W 10-9,*,3,4,75.0,11,0,0,2.8,2.75,77.1,2,10,1,9,0,9.0,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,10,13.9,0,0.0,0,0.0
71,71,1,1,2023-09-10,BAL,,HOU,W 25-9,*,17,22,77.3,169,0,1,7.7,5.64,79.5,4,14,6,38,0,6.3,0,0,0,0,,,0.0,0,0,0,0,0,0,2,1,0,0,0,0,64,100.0,0,0.0,0,0.0
72,72,2,2,2023-09-17,BAL,@,CIN,W 27-24,*,24,33,72.7,237,2,0,7.2,8.39,112.8,0,0,12,54,0,4.5,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,75,100.0,0,0.0,0,0.0
73,73,3,3,2023-09-24,BAL,,IND,L 19-22 (OT),*,22,31,71.0,202,0,0,6.5,6.52,88.4,4,24,14,101,2,7.2,0,0,0,0,,,0.0,0,0,0,0,0,0,2,1,0,2,0,0,72,100.0,0,0.0,0,0.0
74,74,4,4,2023-10-01,BAL,@,CLE,W 28-3,*,15,19,78.9,186,2,0,9.8,11.89,142.5,3,21,9,27,2,3.0,0,0,0,0,,,0.0,0,0,0,0,0,0,2,1,0,1,-3,0,55,94.8,0,0.0,0,0.0
75,75,5,5,2023-10-08,BAL,@,PIT,L 10-17,*,22,38,57.9,236,0,1,6.2,5.03,65.2,4,26,6,45,0,7.5,0,0,0,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,70,100.0,0,0.0,0,0.0
76,76,6,6,2023-10-15,BAL,@,TEN,W 24-16,*,21,30,70.0,223,1,1,7.4,6.60,88.6,1,2,13,62,0,4.8,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,71,100.0,0,0.0,0,0.0
77,77,7,7,2023-10-22,BAL,,DET,W 38-6,*,21,27,77.8,357,3,0,13.2,15.44,155.8,0,0,9,36,1,4.0,0,0,0,0,,,0.0,0,0,0,0,0,0,1,1,0,0,-4,0,57,95.0,0,0.0,0,0.0
78,78,8,8,2023-10-29,BAL,@,ARI,W 31-24,*,18,27,66.7,157,1,0,5.8,6.56,94.2,4,19,5,17,0,3.4,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,65,100.0,0,0.0,0,0.0
79,79,9,9,2023-11-05,BAL,,SEA,W 37-3,*,21,26,80.8,187,0,0,7.2,7.19,96.6,1,8,10,60,0,6.0,0,0,0,0,,,0.0,0,0,0,0,0,0,2,1,0,1,0,0,57,75.0,0,0.0,0,0.0
80,80,10,10,2023-11-12,BAL,,CLE,L 31-33,*,13,23,56.5,223,1,2,9.7,6.65,67.8,3,23,8,41,0,5.1,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,54,100.0,0,0.0,0,0.0
81,81,11,11,2023-11-16,BAL,,CIN,W 34-20,*,16,26,61.5,264,2,0,10.2,11.69,121.3,3,16,9,54,0,6.0,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,66,100.0,0,0.0,0,0.0
82,82,12,12,2023-11-26,BAL,@,LAC,W 20-10,*,18,32,56.3,177,1,0,5.5,6.16,82.4,2,13,11,39,0,3.5,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,71,100.0,0,0.0,0,0.0
83,83,13,14,2023-12-10,BAL,,LAR,W 37-31 (OT),*,24,43,55.8,316,3,1,7.3,7.70,92.8,2,6,11,70,0,6.4,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,72,100.0,0,0.0,0,0.0
84,84,14,15,2023-12-17,BAL,@,JAX,W 23-7,*,14,24,58.3,171,1,1,7.1,6.08,76.9,3,26,12,97,0,8.1,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,70,100.0,0,0.0,0,0.0
85,85,15,16,2023-12-25,BAL,@,SFO,W 33-19,*,23,35,65.7,252,2,0,7.2,8.34,105.9,2,11,7,45,0,6.4,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,68,100.0,0,0.0,0,0.0
86,86,16,17,2023-12-31,BAL,,MIA,W 56-19,*,18,21,85.7,321,5,0,15.3,20.05,158.3,1,9,6,35,0,5.8,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,53,93.0,0,0.0,0,0.0
87,87,1,1,2024-09-05,BAL,@,KAN,L 20-27,*,26,41,63.4,273,1,0,6.7,7.15,90.8,1,6,16,122,0,7.6,0,0,0,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,80,100.0,0,0.0,0,0.0
88,88,2,2,2024-09-15,BAL,,LVR,L 23-26,*,21,34,61.8,247,1,1,7.3,6.53,81.4,2,15,5,45,0,9.0,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,65,100.0,0,0.0,0,0.0
89,89,3,3,2024-09-22,BAL,@,DAL,W 28-25,*,12,15,80.0,182,1,0,12.1,13.47,139.4,0,0,14,87,1,6.2,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,63,100.0,0,0.0,0,0.0
90,90,4,4,2024-09-29,BAL,,BUF,W 35-10,*,13,18,72.2,156,2,0,8.7,10.89,135.4,1,1,6,54,1,9.0,0,0,0,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,54,94.7,0,0.0,0,0.0
91,91,5,5,2024-10-06,BAL,@,CIN,W 41-38 (OT),*,26,42,61.9,348,4,0,8.3,10.19,119.9,1,3,12,55,0,4.6,0,0,0,0,,,0.0,0,0,0,0,0,0,2,1,0,1,-4,0,78,100.0,0,0.0,0,0.0
92,92,6,6,2024-10-13,BAL,,WAS,W 30-23,*,20,26,76.9,323,1,1,12.4,11.46,114.7,2,15,11,40,0,3.6,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,1,0,0,68,100.0,0,0.0,0,0.0
93,93,7,7,2024-10-21,BAL,@,TAM,W 41-31,*,17,22,77.3,281,5,0,12.8,17.32,158.1,2,17,9,52,0,5.8,0,0,0,0,,,0.0,0,0,0,0,0,0,1,1,0,1,-15,0,56,94.9,0,0.0,0,0.0
94,94,8,8,2024-10-27,BAL,@,CLE,L 24-29,*,23,38,60.5,289,2,0,7.6,8.66,101.8,3,26,8,46,0,5.8,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,68,100.0,0,0.0,0,0.0
95,95,9,9,2024-11-03,BAL,,DEN,W 41-10,*,16,19,84.2,280,3,0,14.7,17.89,158.3,1,11,3,4,0,1.3,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,1,0,0,51,89.5,0,0.0,0,0.0
96,96,10,10,2024-11-07,BAL,,CIN,W 35-34,*,25,33,75.8,290,4,0,8.8,11.21,141.4,0,0,7,33,0,4.7,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,63,100.0,0,0.0,0,0.0
97,97,11,11,2024-11-17,BAL,@,PIT,L 16-18,*,16,33,48.5,207,1,1,6.3,5.52,66.1,2,2,4,46,0,11.5,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,61,100.0,0,0.0,0,0.0
98,98,12,12,2024-11-25,BAL,@,LAC,W 30-23,*,16,22,72.7,177,2,0,8.0,9.86,126.5,1,0,8,15,1,1.9,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,65,100.0,0,0.0,0,0.0
99,99,13,13,2024-12-01,BAL,,PHI,L 19-24,*,23,36,63.9,237,2,0,6.6,7.69,101.3,3,31,8,79,0,9.9,0,0,0,0,,,0.0,0,0,0,0,0,0,2,0,0,1,-9,0,72,100.0,0,0.0,0,0.0
100,100,14,15,2024-12-15,BAL,@,NYG,W 35-14,*,21,25,84.0,290,5,0,11.6,15.60,154.6,2,10,6,65,0,10.8,0,0,0,0,,,0.0,0,0,0,0,0,0,1,1,0,0,0,0,49,83.1,0,0.0,0,0.0
101,101,15,16,2024-12-21,BAL,,PIT,W 34-17,*,15,23,65.2,207,3,1,9.0,9.65,115.4,1,9,9,22,0,2.4,0,0,0,0,,,0.0,0,0,0,0,0,0,1,0,0,0,0,0,62,100.0,0,0.0,0,0.0
102,102,16,17,2024-12-25,BAL,@,HOU,W 31-2,*,10,15,66.7,168,2,0,11.2,13.87,143.9,1,3,4,87,1,21.8,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,52,82.5,0,0.0,0,0.0
103,103,17,18,2025-01-04,BAL,,CLE,W 35-10,*,16,32,50.0,217,2,0,6.8,8.03,92.8,0,0,9,63,0,7.0,0,0,0,0,,,0.0,0,0,0,0,0,0,0,0,0,0,0,0,67,95.7,0,0.0,0,0.0
,,,,,,,,74-29,,1678,2586,64.9,20059,166,49,7.8,8.19,102.0,192,1008,1014,6173,33,6.1,2,0,0,0,0.0,0.0,0.0,1,1,0,0,0,0,63,26,0,26,-64,0,6123,86.8,0,0.0,0,0.0'''

# Convert to DataFrame, skip the first row/headers
df = pd.read_csv(io.StringIO(raw_data), skiprows=1)

# Select essential columns
columns_to_keep = ['Rk', 'Gcar', 'Gtm', 'Week', 'Date', 'Team', 'Opp', 'GS', 'Cmp', 'Att', 
                   'Cmp%', 'Yds', 'TD', 'Int', 'Y/A', 'AY/A', 'Rate', 'Sk', 'Yds.1', 
                   'Att.1', 'Yds.2', 'TD.1', 'Y/A.1', 'Fmb']

#Keep only essential columns and rename for clarity
df_clean = df[columns_to_keep].copy()
df_clean.columns = ['Rank', 'Game_Career', 'Game_Team', 'Week', 'Date', 'Team', 'Opponent', 'GS',
                    'Completions', 'Attempts', 'Completion_Pct', 'Pass_Yds', 'Pass_TD', 'INT',
                    'Yards_per_Attempt', 'Adj_Yards_per_Attempt', 'Passer_Rating', 'Sacks',
                    'Sack_Yards', 'Rush_Att', 'Rush_Yds', 'Rush_TD', 'Yards_per_Rush', 'Fumbles']
df_clean = df_clean[pd.to_numeric(df_clean['Week'], errors='coerce').notna()]

# Convert numeric columns to proper types
numeric_cols = ['Rank', 'Game_Career', 'Game_Team', 'Week', 'Completions', 'Attempts', 
                'Completion_Pct', 'Pass_Yds', 'Pass_TD', 'INT', 'Yards_per_Attempt',
                'Adj_Yards_per_Attempt', 'Passer_Rating', 'Sacks', 'Sack_Yards',
                'Rush_Att', 'Rush_Yds', 'Rush_TD', 'Yards_per_Rush', 'Fumbles']

for col in numeric_cols:
    df_clean[col] = pd.to_numeric(df_clean[col], errors='coerce')

# Calculate fantasy points (PPR scoring)
df_clean['Fantasy_Points'] = (
    (df_clean['Pass_Yds'] / 25) + 
    (df_clean['Pass_TD'] * 4) + 
    (df_clean['Rush_Yds'] / 10) + 
    (df_clean['Rush_TD'] * 6) - 
    (df_clean['INT'] * 2) - 
    (df_clean['Fumbles'] * 2)
)

# Clean team abbreviations to current formats
team_map = {
    "SFO": "SF",
    "NWE": "NE",
    "LVR": "LV",
    "OAK": "LV",
    "TAM": "TB",
    "NOR": "NO",
    "GNB": "GB",
    "KAN": "KC",
}
df_clean['Opponent'] = df_clean['Opponent'].replace(team_map)
df_clean['Team'] = df_clean['Team'].replace(team_map)

# Add Season column
df_clean['Date'] = pd.to_datetime(df_clean['Date'], errors='coerce')
df_clean['Season'] = df_clean['Date'].dt.year

# Add QB name
df_clean['QB'] = qb_name

# Save cleaned data to CSV
filename = qb_name.lower().replace(' ', '_') + '_complete_game_logs.csv'
df_clean.to_csv(filename, index=False)
print(f"saved {len(df_clean)} games to {filename}")